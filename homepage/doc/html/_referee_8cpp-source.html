<html>

<!-- headline -->

<head>
  <title>BV3D documentation</title>

  <link rel="stylesheet" type="text/css" href="doxygen.css">
  <style type="text/css">
    body          { color: black; background-color: #F8F8F0; }

    .header       { font-family: Verdana;
                    border-width: 0px; border-bottom-width: 1px;
                    border-style: solid; border-color: black; }

    .logo         { color: #EEEEEE; background-color: #336699;
                                    font-size: 15px; text-decoration: none; }
    .logo:hover   { text-decoration: underline; background-color: #336699; }

    .bottom       { font-family: Verdana; font-size: 10px;
                    text-align: center; text-decoration: none; }
    .bottom:hover { text-decoration: underline; color: black; }
  </style>
</head>

<body leftMargin="0" topMargin="0" marginheight="0" marginwidth="0">
<!-- Generated by Doxygen 1.5.3 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
  </ul>
</div>
<h1>Referee.cpp</h1><a href="_referee_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include "<a class="code" href="_constants_8h.html">Constants.h</a>"</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include "<a class="code" href="_referee_8h.html">Referee.h</a>"</span>
<a name="l00003"></a>00003 <span class="preprocessor">#include "<a class="code" href="_hud_8h.html">Hud.h</a>"</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include "<a class="code" href="_game_8h.html">Game.h</a>"</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="keyword">using namespace </span>BV3D;
<a name="l00007"></a>00007 
<a name="l00008"></a><a class="code" href="class_b_v3_d_1_1_referee.html#c0b512bc89c0ba0e16b98ea1c2408a72">00008</a> Referee::Referee(SO&lt;Game&gt; game)
<a name="l00009"></a>00009 {
<a name="l00010"></a>00010         <a class="code" href="class_b_v3_d_1_1_referee.html#1b336d6ce8d19a3d583de9690657041f">mGame</a> = game;
<a name="l00011"></a>00011         mScore[0] = mScore[1] = mContacts[0] = mContacts[1] = 0; <span class="comment">//set start values</span>
<a name="l00012"></a>00012         mWinningScore = mMaxContacts = mMinDifference = 1;              <span class="comment">//set dummy values</span>
<a name="l00013"></a>00013         <a class="code" href="class_b_v3_d_1_1_referee.html#19237855384797f89da12c3461f595af">mServingTeam</a> = <a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33d09e85e6f59c08bc7b3a3d5bb0bf04af">BV3D::TEAM1</a>;
<a name="l00014"></a>00014         <a class="code" href="class_b_v3_d_1_1_referee.html#812e8ce09392bb456efa01215a1b3d40">mActive</a> = <span class="keyword">true</span>;
<a name="l00015"></a>00015         mHud = 0;
<a name="l00016"></a>00016 }
<a name="l00017"></a>00017 
<a name="l00018"></a><a class="code" href="class_b_v3_d_1_1_referee.html#62352262cdefc5f18351c4c48fed8e58">00018</a> SO&lt;Game&gt; <a class="code" href="class_b_v3_d_1_1_referee.html#62352262cdefc5f18351c4c48fed8e58">Referee::getGame</a>()
<a name="l00019"></a>00019 {
<a name="l00020"></a>00020         <span class="keywordflow">return</span> <a class="code" href="class_b_v3_d_1_1_referee.html#1b336d6ce8d19a3d583de9690657041f">mGame</a>;
<a name="l00021"></a>00021 }
<a name="l00022"></a>00022 
<a name="l00026"></a><a class="code" href="class_b_v3_d_1_1_referee.html#8fe0a864db89483e61f79497b4f70a6a">00026</a> <span class="keywordtype">int</span> <a class="code" href="class_b_v3_d_1_1_referee.html#8fe0a864db89483e61f79497b4f70a6a">Referee::getCurrentScore</a>(<a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33">TEAM</a> team)
<a name="l00027"></a>00027 {
<a name="l00028"></a>00028         <span class="keywordflow">return</span> mScore[<a class="code" href="class_b_v3_d_1_1_referee.html#68cb4cb2d1c040fbdfe72395946c64ae">getTeamIndex</a>(team)];
<a name="l00029"></a>00029 }
<a name="l00030"></a>00030 
<a name="l00034"></a><a class="code" href="class_b_v3_d_1_1_referee.html#a91a6f461a3deff4053f58a888538597">00034</a> <span class="keywordtype">int</span> <a class="code" href="class_b_v3_d_1_1_referee.html#a91a6f461a3deff4053f58a888538597">Referee::getCurrentContacts</a>(<a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33">TEAM</a> team)
<a name="l00035"></a>00035 {
<a name="l00036"></a>00036         <span class="keywordflow">return</span> mContacts[<a class="code" href="class_b_v3_d_1_1_referee.html#68cb4cb2d1c040fbdfe72395946c64ae">getTeamIndex</a>(team)];
<a name="l00037"></a>00037 }
<a name="l00038"></a>00038 
<a name="l00042"></a><a class="code" href="class_b_v3_d_1_1_referee.html#2d38ece9ab36a27b9afa8f41b5052af4">00042</a> <span class="keywordtype">int</span> <a class="code" href="class_b_v3_d_1_1_referee.html#2d38ece9ab36a27b9afa8f41b5052af4">Referee::getWinningScore</a>()
<a name="l00043"></a>00043 {
<a name="l00044"></a>00044         <span class="keywordflow">return</span> mWinningScore;
<a name="l00045"></a>00045 }
<a name="l00046"></a>00046 
<a name="l00050"></a><a class="code" href="class_b_v3_d_1_1_referee.html#184e4412476a0afd0a7402907cacb59d">00050</a> <span class="keywordtype">int</span> <a class="code" href="class_b_v3_d_1_1_referee.html#184e4412476a0afd0a7402907cacb59d">Referee::getMaximumContacts</a>()
<a name="l00051"></a>00051 {
<a name="l00052"></a>00052         <span class="keywordflow">return</span> mMaxContacts;
<a name="l00053"></a>00053 }
<a name="l00054"></a>00054 
<a name="l00058"></a><a class="code" href="class_b_v3_d_1_1_referee.html#0fea4eb1b28e7a3164025e8c02f43ef0">00058</a> <span class="keywordtype">int</span> <a class="code" href="class_b_v3_d_1_1_referee.html#0fea4eb1b28e7a3164025e8c02f43ef0">Referee::getMinimumDifference</a>()
<a name="l00059"></a>00059 {
<a name="l00060"></a>00060         <span class="keywordflow">return</span> mMinDifference;
<a name="l00061"></a>00061 }
<a name="l00062"></a>00062 
<a name="l00067"></a><a class="code" href="class_b_v3_d_1_1_referee.html#f5f58ad8689126c48b48ce4ea567cc45">00067</a> <a class="code" href="namespace_b_v3_d.html#be819f8b3335a1c1bab63feabab4d080">BV3D_ERROR</a> <a class="code" href="class_b_v3_d_1_1_referee.html#f5f58ad8689126c48b48ce4ea567cc45">Referee::setWinningScore</a>(<span class="keywordtype">int</span> winningScore)
<a name="l00068"></a>00068 {
<a name="l00069"></a>00069         <span class="keywordflow">if</span> (winningScore &gt; 0)
<a name="l00070"></a>00070         {
<a name="l00071"></a>00071                 mWinningScore = winningScore;
<a name="l00072"></a>00072                 <span class="keywordflow">return</span> <a class="code" href="namespace_b_v3_d.html#be819f8b3335a1c1bab63feabab4d080bee4089a7b6e67febf33644e98ad831b">NO_ERROR</a>;
<a name="l00073"></a>00073         }
<a name="l00074"></a>00074         <span class="keywordflow">else</span>
<a name="l00075"></a>00075                 <span class="keywordflow">return</span> <a class="code" href="namespace_b_v3_d.html#be819f8b3335a1c1bab63feabab4d080b13be40f866fea7f22f19ae680ed43e2">INVALID_PARAMETER</a>;
<a name="l00076"></a>00076 }
<a name="l00077"></a>00077 
<a name="l00082"></a><a class="code" href="class_b_v3_d_1_1_referee.html#a506d434fa70cb84107ec95e17f6b97d">00082</a> <a class="code" href="namespace_b_v3_d.html#be819f8b3335a1c1bab63feabab4d080">BV3D_ERROR</a> <a class="code" href="class_b_v3_d_1_1_referee.html#a506d434fa70cb84107ec95e17f6b97d">Referee::setMaximumContacts</a>(<span class="keywordtype">int</span> maxContacts)
<a name="l00083"></a>00083 {
<a name="l00084"></a>00084         <span class="keywordflow">if</span> (maxContacts &gt; 0)
<a name="l00085"></a>00085         {
<a name="l00086"></a>00086                 mMaxContacts = maxContacts;
<a name="l00087"></a>00087                 <span class="keywordflow">return</span> <a class="code" href="namespace_b_v3_d.html#be819f8b3335a1c1bab63feabab4d080bee4089a7b6e67febf33644e98ad831b">NO_ERROR</a>;
<a name="l00088"></a>00088         }
<a name="l00089"></a>00089         <span class="keywordflow">else</span>
<a name="l00090"></a>00090                 <span class="keywordflow">return</span> <a class="code" href="namespace_b_v3_d.html#be819f8b3335a1c1bab63feabab4d080b13be40f866fea7f22f19ae680ed43e2">INVALID_PARAMETER</a>;
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00097"></a><a class="code" href="class_b_v3_d_1_1_referee.html#d38d2e48799f83ca940538bf94141c62">00097</a> <a class="code" href="namespace_b_v3_d.html#be819f8b3335a1c1bab63feabab4d080">BV3D_ERROR</a> <a class="code" href="class_b_v3_d_1_1_referee.html#d38d2e48799f83ca940538bf94141c62">Referee::setMinimumDifference</a>(<span class="keywordtype">int</span> minDifference)
<a name="l00098"></a>00098 {
<a name="l00099"></a>00099         <span class="keywordflow">if</span> (minDifference &gt; 0)
<a name="l00100"></a>00100         {
<a name="l00101"></a>00101                 mMinDifference = minDifference;
<a name="l00102"></a>00102                 <span class="keywordflow">return</span> <a class="code" href="namespace_b_v3_d.html#be819f8b3335a1c1bab63feabab4d080bee4089a7b6e67febf33644e98ad831b">NO_ERROR</a>;
<a name="l00103"></a>00103         }
<a name="l00104"></a>00104         <span class="keywordflow">else</span>
<a name="l00105"></a>00105                 <span class="keywordflow">return</span> <a class="code" href="namespace_b_v3_d.html#be819f8b3335a1c1bab63feabab4d080b13be40f866fea7f22f19ae680ed43e2">INVALID_PARAMETER</a>;
<a name="l00106"></a>00106 }
<a name="l00107"></a>00107 
<a name="l00111"></a><a class="code" href="class_b_v3_d_1_1_referee.html#0a6a056037db5abbd1f72532e951c43b">00111</a> <span class="keywordtype">void</span> <a class="code" href="class_b_v3_d_1_1_referee.html#0a6a056037db5abbd1f72532e951c43b">Referee::startNewGame</a>()
<a name="l00112"></a>00112 {
<a name="l00113"></a>00113         mScore[0] = mScore[1] = mContacts[0] = mContacts[1] = 0;
<a name="l00114"></a>00114         <a class="code" href="class_b_v3_d_1_1_referee.html#19237855384797f89da12c3461f595af">mServingTeam</a> = <a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33d09e85e6f59c08bc7b3a3d5bb0bf04af">TEAM1</a>;
<a name="l00115"></a>00115         <span class="keywordflow">if</span>(mHud)
<a name="l00116"></a>00116                 mHud-&gt;setScore(0,0,<a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33d09e85e6f59c08bc7b3a3d5bb0bf04af">TEAM1</a>);
<a name="l00117"></a>00117 }
<a name="l00118"></a>00118 
<a name="l00122"></a><a class="code" href="class_b_v3_d_1_1_referee.html#990ca4fd7fac2e779744aa1f07878b6e">00122</a> <span class="keywordtype">int</span> <a class="code" href="class_b_v3_d_1_1_referee.html#990ca4fd7fac2e779744aa1f07878b6e">Referee::increaseScore</a>(<a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33">TEAM</a> team)
<a name="l00123"></a>00123 {
<a name="l00124"></a>00124         mScore[<a class="code" href="class_b_v3_d_1_1_referee.html#68cb4cb2d1c040fbdfe72395946c64ae">getTeamIndex</a>(team)]++;
<a name="l00125"></a>00125         <span class="keywordflow">if</span>(mHud)
<a name="l00126"></a>00126                 mHud-&gt;setScore(mScore[<a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33d09e85e6f59c08bc7b3a3d5bb0bf04af">TEAM1</a>],mScore[<a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b3345971865607150184ec749bad83a63bd">TEAM2</a>],team);
<a name="l00127"></a>00127         <span class="keywordflow">return</span> mScore[<a class="code" href="class_b_v3_d_1_1_referee.html#68cb4cb2d1c040fbdfe72395946c64ae">getTeamIndex</a>(team)];
<a name="l00128"></a>00128 }
<a name="l00129"></a>00129 
<a name="l00133"></a><a class="code" href="class_b_v3_d_1_1_referee.html#6b7872b5a040ac371d083f775098bf71">00133</a> <span class="keywordtype">int</span> <a class="code" href="class_b_v3_d_1_1_referee.html#6b7872b5a040ac371d083f775098bf71">Referee::increaseContacts</a>(<a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33">TEAM</a> team)
<a name="l00134"></a>00134 {
<a name="l00135"></a>00135         <span class="keywordflow">return</span> ++mContacts[<a class="code" href="class_b_v3_d_1_1_referee.html#68cb4cb2d1c040fbdfe72395946c64ae">getTeamIndex</a>(team)];
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 
<a name="l00141"></a><a class="code" href="class_b_v3_d_1_1_referee.html#7fe9bbf7201ae395a6e3e24a83a9f221">00141</a> <span class="keywordtype">void</span> <a class="code" href="class_b_v3_d_1_1_referee.html#7fe9bbf7201ae395a6e3e24a83a9f221">Referee::resetContacts</a>(<a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33">TEAM</a> team)
<a name="l00142"></a>00142 {
<a name="l00143"></a>00143         mContacts[<a class="code" href="class_b_v3_d_1_1_referee.html#68cb4cb2d1c040fbdfe72395946c64ae">getTeamIndex</a>(team)] = 0;
<a name="l00144"></a>00144 }
<a name="l00145"></a>00145 
<a name="l00149"></a><a class="code" href="class_b_v3_d_1_1_referee.html#8a69c410ff7d922116d3c78199b9c784">00149</a> <span class="keywordtype">bool</span> <a class="code" href="class_b_v3_d_1_1_referee.html#8a69c410ff7d922116d3c78199b9c784">Referee::isGameOver</a>()
<a name="l00150"></a>00150 {
<a name="l00151"></a>00151         <span class="keywordtype">int</span> a = 0;
<a name="l00152"></a>00152         <span class="keywordtype">int</span> b = 1;
<a name="l00153"></a>00153         <span class="keywordflow">if</span> (mScore[a] == mScore[b])
<a name="l00154"></a>00154                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00155"></a>00155         
<a name="l00156"></a>00156         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mScore[a] &lt; mScore[b]) <span class="comment">// make sure that 'a' is the one with highest score</span>
<a name="l00157"></a>00157         {
<a name="l00158"></a>00158                 <span class="keywordtype">int</span> temp = a;
<a name="l00159"></a>00159                 a = b;
<a name="l00160"></a>00160                 b = temp;
<a name="l00161"></a>00161         }
<a name="l00162"></a>00162         <span class="keywordflow">return</span> ( ((mScore[a] - mScore[b]) &gt;= <a class="code" href="class_b_v3_d_1_1_referee.html#0fea4eb1b28e7a3164025e8c02f43ef0">getMinimumDifference</a>()) &amp;&amp; (mScore[a] &gt;= <a class="code" href="class_b_v3_d_1_1_referee.html#2d38ece9ab36a27b9afa8f41b5052af4">getWinningScore</a>()) );
<a name="l00163"></a>00163 }
<a name="l00164"></a>00164 
<a name="l00168"></a><a class="code" href="class_b_v3_d_1_1_referee.html#68cb4cb2d1c040fbdfe72395946c64ae">00168</a> <span class="keywordtype">int</span> <a class="code" href="class_b_v3_d_1_1_referee.html#68cb4cb2d1c040fbdfe72395946c64ae">Referee::getTeamIndex</a>(<a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33">TEAM</a> team)
<a name="l00169"></a>00169 {
<a name="l00170"></a>00170         <span class="keywordflow">if</span>(team == <a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33d09e85e6f59c08bc7b3a3d5bb0bf04af">TEAM1</a>)
<a name="l00171"></a>00171                 <span class="keywordflow">return</span> 0;
<a name="l00172"></a>00172         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(team == <a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b3345971865607150184ec749bad83a63bd">TEAM2</a>)
<a name="l00173"></a>00173                 <span class="keywordflow">return</span> 1;
<a name="l00174"></a>00174         <span class="keywordflow">else</span>
<a name="l00175"></a>00175         {
<a name="l00176"></a>00176                 printf(<span class="stringliteral">"ERROR: Unknown team occured!"</span>);
<a name="l00177"></a>00177                 <span class="keywordflow">return</span> -1;              <span class="comment">//TODO: throw error</span>
<a name="l00178"></a>00178         }
<a name="l00179"></a>00179 }
<a name="l00180"></a>00180 
<a name="l00184"></a><a class="code" href="class_b_v3_d_1_1_referee.html#66c9730f2cc7863fed00d866d8f27755">00184</a> <a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33">TEAM</a> <a class="code" href="class_b_v3_d_1_1_referee.html#66c9730f2cc7863fed00d866d8f27755">Referee::getOpponent</a>(<a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33">TEAM</a> team)
<a name="l00185"></a>00185 {
<a name="l00186"></a>00186         <span class="keywordflow">if</span>(team == <a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33d09e85e6f59c08bc7b3a3d5bb0bf04af">TEAM1</a>)
<a name="l00187"></a>00187                 <span class="keywordflow">return</span> <a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b3345971865607150184ec749bad83a63bd">TEAM2</a>;
<a name="l00188"></a>00188         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (team == <a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b3345971865607150184ec749bad83a63bd">TEAM2</a>)
<a name="l00189"></a>00189                 <span class="keywordflow">return</span> <a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33d09e85e6f59c08bc7b3a3d5bb0bf04af">TEAM1</a>;
<a name="l00190"></a>00190         <span class="keywordflow">else</span>
<a name="l00191"></a>00191         {
<a name="l00192"></a>00192                 printf(<span class="stringliteral">"ERROR: Unknown team occured!"</span>);
<a name="l00193"></a>00193                 <span class="keywordflow">return</span> <a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33d09e85e6f59c08bc7b3a3d5bb0bf04af">TEAM1</a>;           <span class="comment">//TODO: throw error </span>
<a name="l00194"></a>00194         }
<a name="l00195"></a>00195 }
<a name="l00196"></a>00196 
<a name="l00197"></a><a class="code" href="class_b_v3_d_1_1_referee.html#aa7aeebed0974a7de6332f23b4619e6d">00197</a> <span class="keywordtype">void</span> <a class="code" href="class_b_v3_d_1_1_referee.html#aa7aeebed0974a7de6332f23b4619e6d">BV3D::Referee::gameOver</a>(<a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33">BV3D::TEAM</a> winner)
<a name="l00198"></a>00198 {
<a name="l00199"></a>00199         <span class="keywordflow">if</span>(mHud)
<a name="l00200"></a>00200                 mHud-&gt;showWinner(winner);
<a name="l00201"></a>00201 }
<a name="l00202"></a>00202 
<a name="l00203"></a><a class="code" href="class_b_v3_d_1_1_referee.html#4da4e30b4c8309d8144c96a121991ce7">00203</a> <span class="keywordtype">void</span> <a class="code" href="class_b_v3_d_1_1_referee.html#4da4e30b4c8309d8144c96a121991ce7">BV3D::Referee::newServe</a>(<a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33">BV3D::TEAM</a> servingTeam)
<a name="l00204"></a>00204 {
<a name="l00205"></a>00205         <a class="code" href="class_b_v3_d_1_1_referee.html#19237855384797f89da12c3461f595af">mServingTeam</a> = servingTeam;
<a name="l00206"></a>00206         <a class="code" href="class_b_v3_d_1_1_referee.html#1b336d6ce8d19a3d583de9690657041f">mGame</a>-&gt;scheduleNewServe();
<a name="l00207"></a>00207         <span class="keywordflow">if</span>(mHud)
<a name="l00208"></a>00208                 mHud-&gt;setScore(mScore[<a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b33d09e85e6f59c08bc7b3a3d5bb0bf04af">TEAM1</a>],mScore[<a class="code" href="namespace_b_v3_d.html#710b8aa44c0c4f2ea6f76d9bce2d3b3345971865607150184ec749bad83a63bd">TEAM2</a>],servingTeam);
<a name="l00209"></a>00209 }
</pre></div><!-- bottom line -->
<address><small>
  Generated on Thu Sep 13 00:43:09 2007 by <a href="http://www.doxygen.org/index.html">Doxygen</a> 1.5.3
</small></address>

</body>

</html>
